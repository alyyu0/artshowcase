-- (Supabase-ready SQL with UUIDs and storage URLs)
-- Create (or update) the function to handle new user signup
CREATE OR REPLACE FUNCTION public.handle_new_user() 
RETURNS trigger AS $$
BEGIN
  INSERT INTO public.users (user_id, email, username, profile_picture)
  VALUES (
    new.id,
    new.email,
    COALESCE(new.raw_user_meta_data->>'username', 'New User'),
    'https://placehold.co/400?text=New+User'
  );
  RETURN new;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

DROP TRIGGER IF EXISTS on_auth_user_created ON auth.users;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE PROCEDURE public.handle_new_user();

-- USERS (explicit UUIDs)
INSERT INTO users (user_id, username, email, password, bio, profile_picture)
VALUES
('00000000-0000-0000-0000-000000000001', 'GwenVere', 'gwen@example.com', 'placeholder', 'Hopes and dreams', 'https://ui-avatars.com/api/?name=GwenVere&background=random'),
('00000000-0000-0000-0000-000000000002', 'thecreature', 'creature@example.com', 'placeholder', 'hi!', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/profile%20pictures/Screenshot%202024-09-12%20220016.png'),
('00000000-0000-0000-0000-000000000003', 'cr4n3w1v3sf4n', 'crane@example.com', 'placeholder', 'I like music and art', 'https://ui-avatars.com/api/?name=Crane&background=random'),
('00000000-0000-0000-0000-000000000004', 'livinglife_', 'living@example.com', 'placeholder', 'Newbie', 'https://ui-avatars.com/api/?name=LivingLife&background=random'),
('00000000-0000-0000-0000-000000000005', 'swirlswirlswirl', 'swirl@example.com', 'placeholder', 'cute posting', 'https://ui-avatars.com/api/?name=Swirl&background=random'),
('00000000-0000-0000-0000-000000000006', 'gl1de', 'glide@example.com', 'placeholder', 'sketches', 'https://ui-avatars.com/api/?name=Glide&background=random'),
('00000000-0000-0000-0000-000000000007', 'JadeHalley', 'jade@example.com', 'placeholder', 'Trying digital art', 'https://ui-avatars.com/api/?name=JadeHalley&background=random'),
('00000000-0000-0000-0000-000000000008', 'bluebirdhumming', 'bluebird@example.com', 'placeholder', 'Just some guy', 'https://ui-avatars.com/api/?name=BlueBird&background=random'),
('00000000-0000-0000-0000-000000000009', 'eichisurvivor', 'eichi@example.com', 'placeholder', 'just passing time', 'https://ui-avatars.com/api/?name=Eichi&background=random'),
('00000000-0000-0000-0000-000000000010', 'user10', 'user10@example.com', 'placeholder', 'Bio of user10', 'https://ui-avatars.com/api/?name=User10&background=random'),
('00000000-0000-0000-0000-000000000011', 'user11', 'user11@example.com', 'placeholder', 'Bio of user11', 'https://ui-avatars.com/api/?name=User11&background=random'),
('00000000-0000-0000-0000-000000000012', 'user12', 'user12@example.com', 'placeholder', 'Bio of user12', 'https://ui-avatars.com/api/?name=User12&background=random'),
('00000000-0000-0000-0000-000000000013', 'user13', 'user13@example.com', 'placeholder', 'Bio of user13', 'https://ui-avatars.com/api/?name=User13&background=random'),
('00000000-0000-0000-0000-000000000014', 'user14', 'user14@example.com', 'placeholder', 'Bio of user14', 'https://ui-avatars.com/api/?name=User14&background=random'),
('00000000-0000-0000-0000-000000000015', 'user15', 'user15@example.com', 'placeholder', 'Bio of user15', 'https://ui-avatars.com/api/?name=User15&background=random');

-- ARTWORK rows (explicit UUIDs and public storage URLs)
INSERT INTO artwork (artwork_id, user_id, title, caption, image_url)
VALUES
('a0000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'Stars', 'A starry night digital painting', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/starrstars.png'),
('a0000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000002', 'Hello', 'Doodle fun', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/IS2638_250928_005133_16(1).jpg'),
('a0000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000003', 'Easier 1', 'Would it be easier?', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/20251203_010236.jpg'),
('a0000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000003', 'Easier 2', 'Another one, thank you', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/20251203_010246.jpg'),
('a0000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000004', 'a test', 'Digital hands study', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/Untitled100_20251203002354.png'),
('a0000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000005', 'idk', 'meooow', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/Untitled8.png'),
('a0000000-0000-0000-0000-000000000007', '00000000-0000-0000-0000-000000000006', 'glide', 'i wanna be just like a melody', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/31.png'),
('a0000000-0000-0000-0000-000000000008', '00000000-0000-0000-0000-000000000007', 'Flowers', 'Tried digital painting', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/flowers.png'),
('a0000000-0000-0000-0000-000000000009', '00000000-0000-0000-0000-000000000008', 'Blue', 'trying oil pastels', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/20251203_003227.jpg'),
('a0000000-0000-0000-0000-000000000010', '00000000-0000-0000-0000-000000000009', 'stranger', 'just a stranger i know everything about', 'https://ulpspecqldijdxjzhlyv.supabase.co/storage/v1/object/public/artworks/20251203_005110.jpg');

-- HASHTAGS
INSERT INTO hashtags (hashtag_id, tag)
VALUES
(1, 'digitalart'), (2, 'stars'), (3, 'doodle'), (4, 'traditionalart'),
(5, 'markers'), (6, 'hands'), (7, 'cute'), (8, 'sketch'),
(9, 'painting'), (10, 'oilpastel'), (11, 'random');

SELECT setval('hashtags_hashtag_id_seq', (SELECT COALESCE(MAX(hashtag_id),0) FROM hashtags));

-- ARTWORK_HASHTAGS
INSERT INTO artwork_hashtags (artwork_id, hashtag_id)
VALUES
('a0000000-0000-0000-0000-000000000001', 1), ('a0000000-0000-0000-0000-000000000001', 2),
('a0000000-0000-0000-0000-000000000002', 3),
('a0000000-0000-0000-0000-000000000003', 4), ('a0000000-0000-0000-0000-000000000003', 5),
('a0000000-0000-0000-0000-000000000004', 4), ('a0000000-0000-0000-0000-000000000004', 5),
('a0000000-0000-0000-0000-000000000005', 1), ('a0000000-0000-0000-0000-000000000005', 6),
('a0000000-0000-0000-0000-000000000006', 1), ('a0000000-0000-0000-0000-000000000006', 7),
('a0000000-0000-0000-0000-000000000007', 1), ('a0000000-0000-0000-0000-000000000007', 8),
('a0000000-0000-0000-0000-000000000008', 1), ('a0000000-0000-0000-0000-000000000008', 9),
('a0000000-0000-0000-0000-000000000009', 4), ('a0000000-0000-0000-0000-000000000009', 10),
('a0000000-0000-0000-0000-000000000010', 4), ('a0000000-0000-0000-0000-000000000010', 3), ('a0000000-0000-0000-0000-000000000010', 11);

-- LIKES
INSERT INTO likes (user_id, artwork_id)
VALUES
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000005'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000005'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000006');

-- COMMENTS
INSERT INTO comments (user_id, artwork_id, comment_text)
VALUES
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001', 'Amazing!'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001', 'So beautiful'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001', 'Love it!'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000002', 'Cool doodle'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000002', 'Nice lines'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000002', 'Fun idea'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000003', 'Great markers work'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000003', 'Looks traditional'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000003', 'I like this'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000004', 'Very detailed'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000004', 'Awesome'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000004', 'Cool piece'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000005', 'Nice hands study'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000005', 'Good shading'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000006', 'So cute!');

-- SAVES
INSERT INTO saves (user_id, artwork_id)
VALUES
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000002', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000005', 'a0000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000001', 'a0000000-0000-0000-0000-000000000005'),
('00000000-0000-0000-0000-000000000003', 'a0000000-0000-0000-0000-000000000005'),
('00000000-0000-0000-0000-000000000004', 'a0000000-0000-0000-0000-000000000006');

-- FOLLOWS
INSERT INTO follows (follower_id, following_id)
VALUES
('00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000002'),
('00000000-0000-0000-0000-000000000007', '00000000-0000-0000-0000-000000000003'),
('00000000-0000-0000-0000-000000000007', '00000000-0000-0000-0000-000000000004'),
('00000000-0000-0000-0000-000000000008', '00000000-0000-0000-0000-000000000005');

-- LEADERBOARD
INSERT INTO leaderboard (artwork_id, month, year, total_likes)
VALUES
('a0000000-0000-0000-0000-000000000001', 11, 2025, 3),
('a0000000-0000-0000-0000-000000000002', 11, 2025, 3),
('a0000000-0000-0000-0000-000000000003', 11, 2025, 3),
('a0000000-0000-0000-0000-000000000004', 11, 2025, 3),
('a0000000-0000-0000-0000-000000000005', 11, 2025, 3),
('a0000000-0000-0000-0000-000000000006', 11, 2025, 1),
('a0000000-0000-0000-0000-000000000007', 11, 2025, 0),
('a0000000-0000-0000-0000-000000000008', 11, 2025, 0),
('a0000000-0000-0000-0000-000000000009', 11, 2025, 0),
('a0000000-0000-0000-0000-000000000010', 11, 2025, 0);
